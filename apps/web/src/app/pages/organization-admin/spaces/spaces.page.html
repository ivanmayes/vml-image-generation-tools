<div class="spaces-page">
	<h1 class="mb-4">Spaces Management</h1>

	<p-toolbar styleClass="mb-4">
		<ng-template pTemplate="start">
			<p-iconfield iconPosition="left">
				<p-inputicon styleClass="pi pi-search"></p-inputicon>
				<input
					pInputText
					type="text"
					(input)="onSearch($event)"
					placeholder="Search spaces..."
					class="w-80"
				/>
			</p-iconfield>
		</ng-template>
		<ng-template pTemplate="end">
			<button
				pButton
				label="Create Space"
				icon="pi pi-plus"
				(click)="openCreateDialog()"
				aria-label="Create Space"
			></button>
		</ng-template>
	</p-toolbar>

	<p-table
		[value]="loading() ? skeletonRows : spaces()"
		[paginator]="true"
		[rows]="10"
		[showCurrentPageReport]="true"
		currentPageReportTemplate="Showing {first} to {last} of {totalRecords} spaces"
		styleClass="p-datatable-striped"
		(onSort)="onSort($event)"
	>
		<ng-template pTemplate="header">
			<tr>
				<th [pSortableColumn]="'name'" class="cursor-pointer">
					Name <p-sortIcon [field]="'name'"></p-sortIcon>
				</th>
				<th [pSortableColumn]="'created'" class="cursor-pointer">
					Created <p-sortIcon [field]="'created'"></p-sortIcon>
				</th>
				<th style="width: 150px">Actions</th>
			</tr>
		</ng-template>

		<ng-template pTemplate="body" let-space>
			@if (!loading()) {
			<tr>
				<td>
					<button
						type="button"
						class="space-name-link p-link"
						(click)="navigateToSpaceAdmin(space.id)"
					>
						{{ space.name }}
					</button>
				</td>
				<td>{{ formatDate(space.created) }}</td>
				<td>
					<div class="action-buttons">
						<button
							pButton
							icon="pi pi-pencil"
							class="p-button-rounded p-button-text p-button-sm"
							pTooltip="Edit Space"
							aria-label="Edit Space"
							(click)="openEditDialog(space)"
						></button>
						<button
							pButton
							icon="pi pi-trash"
							class="p-button-rounded p-button-text p-button-sm p-button-danger"
							pTooltip="Delete Space"
							aria-label="Delete Space"
							(click)="deleteSpace(space)"
						></button>
					</div>
				</td>
			</tr>
			} @else {
			<tr>
				<td><p-skeleton /></td>
				<td><p-skeleton /></td>
				<td><p-skeleton /></td>
			</tr>
			}
		</ng-template>

		<ng-template pTemplate="emptymessage">
			<tr>
				<td colspan="3" class="text-center">
					<div class="empty-state">
						<i
							class="pi pi-inbox"
							style="
								font-size: 3rem;
								color: var(--text-color-secondary);
							"
						></i>
						<p>No spaces found</p>
						<button
							pButton
							label="Create a Space"
							icon="pi pi-plus"
							(click)="openCreateDialog()"
							aria-label="Create a Space"
						></button>
					</div>
				</td>
			</tr>
		</ng-template>
	</p-table>
</div>

<p-confirmDialog></p-confirmDialog>
<p-toast></p-toast>
