<div class="judges-page">
	<!-- Header -->
	<div class="list-header">
		<h1 class="heading-page m-0">Agents</h1>
		<div class="list-header__actions">
			<p-iconfield iconPosition="left">
				<p-inputicon styleClass="pi pi-search"></p-inputicon>
				<input
					pInputText
					type="text"
					(input)="onSearch($event)"
					placeholder="Search agents..."
					class="list-header__search"
				/>
			</p-iconfield>
			<p-button
				label="Create Agent"
				icon="pi pi-plus"
				(onClick)="navigateToCreate()"
			/>
		</div>
	</div>

	<!-- Loading skeleton -->
	@if (loading()) {
	<div class="agent-grid">
		@for (card of skeletonCards; track $index) {
		<div class="agent-card agent-card--skeleton">
			<div class="agent-card__header skeleton-shimmer"></div>
			<div class="agent-card__body">
				<div
					class="skeleton-shimmer"
					style="height: 16px; width: 70%; margin-bottom: 8px"
				></div>
				<div
					class="skeleton-shimmer"
					style="height: 14px; width: 90%; margin-bottom: 4px"
				></div>
				<div
					class="skeleton-shimmer"
					style="height: 14px; width: 55%; margin-bottom: 12px"
				></div>
				<div
					class="skeleton-shimmer"
					style="height: 12px; width: 80%"
				></div>
			</div>
		</div>
		}
	</div>
	}

	<!-- Content -->
	@if (!loading()) {
	<!-- Empty state -->
	@if (agents().length === 0) {
	<div class="list-empty">
		<div class="list-empty__icon">
			<i class="pi pi-users"></i>
		</div>
		<h3 class="heading-section mb-2">No agents yet</h3>
		<p class="text-color-secondary mb-4">
			Create your first agent to start evaluating and generating images.
		</p>
		<p-button
			label="Create your first agent"
			icon="pi pi-plus"
			(onClick)="navigateToCreate()"
		/>
	</div>
	} @else {
	<!-- Card grid -->
	<div class="agent-grid">
		@for (agent of agents(); track agent.id) {
		<div
			class="agent-card"
			role="button"
			tabindex="0"
			(click)="navigateToDetail(agent.id)"
			(keydown.enter)="navigateToDetail(agent.id)"
		>
			<!-- Avatar header -->
			<div class="agent-card__header">
				@if (agent.avatarUrl) {
				<img
					[src]="agent.avatarUrl"
					[alt]="agent.name"
					class="agent-card__avatar-img"
				/>
				} @else {
				<div
					class="agent-card__avatar-placeholder"
					[style.background]="getAvatarGradient(agent.name)"
				>
					<span class="agent-card__initials"
						>{{ getInitials(agent.name) }}</span
					>
				</div>
				}
			</div>

			<!-- Body -->
			<div class="agent-card__body">
				<div class="agent-card__name">{{ agent.name }}</div>

				@if (agent.description) {
				<div class="agent-card__desc">{{ agent.description }}</div>
				} @else {
				<div class="agent-card__desc agent-card__desc--empty">
					No description
				</div>
				}

				<!-- Meta bar -->
				<div class="agent-card__meta">
					<span class="agent-card__meta-item">
						<span
							class="agent-card__status-dot"
							[class.agent-card__status-dot--active]="
								agent.status !== 'INACTIVE'
							"
							[class.agent-card__status-dot--inactive]="
								agent.status === 'INACTIVE'
							"
						></span>
						{{ agent.status === 'INACTIVE' ? 'Inactive' : 'Active'
						}}
					</span>

					@if (agent.agentType) {
					<span class="agent-card__meta-item">
						<i class="pi pi-tag"></i>
						{{ getAgentTypeLabel(agent.agentType) }}
					</span>
					} @if (agent.modelTier) {
					<span class="agent-card__meta-item">
						<i class="pi pi-microchip-ai"></i>
						{{ agent.modelTier }}
					</span>
					} @if (agent.canJudge) {
					<span
						class="agent-card__meta-item agent-card__meta-item--judge"
					>
						<i class="pi pi-check-circle"></i>
						Judge
					</span>
					}

					<span
						class="agent-card__meta-item"
						[pTooltip]="
							(agent.createdAt | date : 'medium')!
						"
						tooltipPosition="top"
					>
						<i class="pi pi-clock"></i>
						{{ getRelativeTime(agent.createdAt) }}
					</span>
				</div>
			</div>

			<!-- Actions -->
			<!-- eslint-disable-next-line @angular-eslint/template/click-events-have-key-events, @angular-eslint/template/interactive-supports-focus -->
			<div class="agent-card__actions" (click)="$event.stopPropagation()">
				<p-button
					icon="pi pi-pencil"
					[rounded]="true"
					[text]="true"
					severity="secondary"
					size="small"
					(onClick)="navigateToDetail(agent.id)"
					pTooltip="Edit"
				/>
				<p-button
					icon="pi pi-trash"
					[rounded]="true"
					[text]="true"
					severity="danger"
					size="small"
					(onClick)="deleteAgent($event, agent)"
					pTooltip="Delete"
				/>
			</div>
		</div>
		}
	</div>
	} }
</div>

<p-confirmDialog></p-confirmDialog>
<p-toast></p-toast>
