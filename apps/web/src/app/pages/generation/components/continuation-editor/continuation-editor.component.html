<div class="continuation-editor">
	<div
		class="continuation-editor__header"
		(click)="toggle()"
		(keydown.enter)="toggle()"
		tabindex="0"
		role="button"
	>
		<div class="continuation-editor__header-left">
			<div class="continuation-editor__icon-block">
				<i class="pi pi-refresh"></i>
			</div>
			<h3 class="heading-card m-0">Continue Generation</h3>
		</div>
		<i
			class="pi continuation-editor__chevron"
			[class.pi-chevron-down]="!expanded()"
			[class.pi-chevron-up]="expanded()"
		>
		</i>
	</div>

	@if (expanded()) {
		<div class="continuation-editor__body">
			<!-- Prompt Override -->
			<div class="field mb-3">
				<label
					class="block text-sm font-semibold mb-2"
					for="continuation-prompt"
					>Prompt (editable)</label
				>
				<textarea
					id="continuation-prompt"
					pTextarea
					[(ngModel)]="promptOverride"
					rows="4"
					class="w-full"
					placeholder="Edit the prompt for continued generation..."
				></textarea>
				<small class="text-color-secondary"
					>Modify the prompt to guide the next round of
					iterations.</small
				>
			</div>

			<!-- Generation Mode -->
			<div class="field mb-3">
				tttt<!-- eslint-disable-next-line @angular-eslint/template/label-has-associated-control -->
				<label
					class="block text-sm font-semibold mb-2"
					id="cont-mode-label"
					>Generation Mode</label
				>
				<p-selectButton
					[options]="generationModeOptions"
					[(ngModel)]="generationMode"
					optionLabel="label"
					optionValue="value"
					(onChange)="onModeChange()"
					tttttaria-labelledby="cont-mode-label"
				/>
			</div>

			<!-- Additional Iterations -->
			<div class="field mb-3">
				<label
					class="block text-sm font-semibold mb-2"
					for="cont-iterations"
					>Additional Iterations</label
				>
				<p-inputNumber
					tttttinputId="cont-iterations"
					[(ngModel)]="additionalIterations"
					[min]="1"
					[max]="getMaxIterationsForMode()"
					[showButtons]="true"
				/>
				@if (generationMode === "edit") {
					<small class="text-color-secondary"
						>Edit mode limited to 5 iterations to prevent quality
						degradation.</small
					>
				}
			</div>

			<!-- Actions -->
			<div class="continuation-editor__actions">
				<p-button
					label="Cancel"
					[text]="true"
					severity="secondary"
					(onClick)="toggle()"
				/>
				<p-button
					label="Continue"
					icon="pi pi-play"
					(onClick)="onContinue()"
					[loading]="submitting()"
				/>
			</div>
		</div>
	}
</div>
