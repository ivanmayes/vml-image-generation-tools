@use "../../../../../theme/utils" as *;

// Host fills parent (flex child of generation-detail-page)
:host {
	display: flex;
	flex: 1;
	min-height: 0;
}

// Root layout: sidebar + gallery side-by-side
.gallery-layout {
	display: flex;
	flex: 1;
	min-height: 0;
	width: 100%;
	background: var(--p-surface-ground);
	overflow: hidden;
}

// Sidebar
.gallery-sidebar {
	width: 360px;
	flex-shrink: 0;
	background: var(--p-surface-0);
	border-right: 1px solid var(--p-surface-200);
	overflow-y: auto;
	padding: 24px;
	display: flex;
	flex-direction: column;
	gap: 16px;

	&__header {
		display: flex;
		align-items: center;
		gap: 8px;
	}

	&__score {
		display: flex;
		align-items: baseline;
		gap: 8px;
	}

	&__score-value {
		font-size: 2rem;
		font-weight: 700;
		font-variant-numeric: tabular-nums;

		&.score--success {
			color: var(--p-green-500);
		}

		&.score--warn {
			color: var(--p-yellow-600);
		}

		&.score--danger {
			color: var(--p-red-500);
		}
	}

	&__score-label {
		font-size: 0.875rem;
		color: var(--p-text-muted-color);
	}

	&__selected-badge {
		display: flex;
		align-items: center;
		gap: 8px;
		padding: 8px 12px;
		background: var(--p-primary-50);
		border-radius: var(--p-content-border-radius);
		color: var(--p-primary-700);
		font-size: 0.875rem;
		font-weight: 500;
	}

	&__top-issue {
		padding: 12px;
		background: var(--p-surface-50);
		border-radius: var(--p-content-border-radius);
		border-left: 3px solid var(--p-orange-500);
	}

	&__eval-header {
		display: flex;
		justify-content: space-between;
		align-items: center;
		width: 100%;
		gap: 8px;
	}

	&__empty {
		padding: 24px;
		text-align: center;
	}
}

// Main gallery area
.gallery-main {
	flex: 1;
	min-width: 0;
	min-height: 0;
	overflow: hidden;
	display: flex;
	flex-direction: column;
	background: var(--p-surface-950);
	padding: 24px;
	gap: 12px;
}

// PrimeNG Galleria deep overrides
:host ::ng-deep .gallery-main {
	p-galleria,
	.p-galleria {
		width: 100%;
		flex: 1;
		min-height: 0;
		display: flex;
		flex-direction: column;
		background: transparent;
		border: none;
	}

	.p-galleria-content {
		flex: 1;
		min-height: 0;
		display: flex;
		flex-direction: column;
		background: transparent;
		border: none;
	}

	.p-galleria-items-container {
		flex: 1;
		min-height: 0;
		position: relative;
		background: transparent;
		border: none;
	}

	.p-galleria-items {
		height: 100%;
	}

	.p-galleria-item {
		height: 100%;
		display: flex;
		align-items: center;
		justify-content: center;
		background: transparent;
		border: none;
	}

	.p-galleria-prev-button,
	.p-galleria-next-button {
		color: rgb(255 255 255 / 80%);
		background: rgb(0 0 0 / 30%);
		border-radius: 50%;
		width: 48px;
		height: 48px;

		&:hover {
			background: rgb(0 0 0 / 50%);
			color: white;
		}
	}

	.p-galleria-footer {
		flex-shrink: 0;
	}
}

.gallery-item {
	height: 100%;
	display: flex;
	align-items: center;
	justify-content: center;

	&__image {
		max-width: 100%;
		max-height: 100%;
		object-fit: contain;
		border-radius: 4px;
	}
}

// Thumbnails
.gallery-thumb {
	position: relative;
	width: 80px;
	height: 80px;
	border-radius: 4px;
	border: 2px solid transparent;
	transition: border-color 0.2s;

	&--group-start {
		margin-left: 12px;

		&::before {
			content: "";
			position: absolute;
			left: -8px;
			top: 10%;
			height: 80%;
			width: 1px;
			background: rgb(255 255 255 / 30%);
			z-index: 1;
		}
	}

	&--active {
		border-color: rgb(255 255 255 / 80%);
	}

	&--selected {
		border-color: var(--p-primary-500);
	}

	&__image {
		width: 100%;
		height: 100%;
		object-fit: cover;
		border-radius: 2px;
	}

	&__iteration-badge {
		position: absolute;
		top: 2px;
		left: 2px;
		width: 20px;
		height: 20px;
		border-radius: 50%;
		background: var(--p-primary-500);
		color: white;
		font-size: 0.65rem;
		font-weight: 700;
		display: flex;
		align-items: center;
		justify-content: center;
		z-index: 1;
	}

	&__selected-badge {
		position: absolute;
		top: 2px;
		right: 2px;
		width: 18px;
		height: 18px;
		border-radius: 50%;
		background: var(--p-green-500);
		color: white;
		font-size: 0.6rem;
		display: flex;
		align-items: center;
		justify-content: center;
		z-index: 1;
	}
}

// Custom thumbnail strip
.thumb-strip {
	flex-shrink: 0;
	display: flex;
	align-items: center;
	gap: 8px;
	background: #1a1a1a;
	border-radius: 8px;
	padding: 8px;

	&__viewport {
		flex: 1;
		min-width: 0;
		overflow: hidden;
	}

	&__track {
		display: flex;
		gap: 4px;
		width: max-content;
	}

	&__nav {
		flex-shrink: 0;
		width: 32px;
		height: 32px;
		border-radius: 50%;
		border: none;
		background: rgb(255 255 255 / 15%);
		color: rgb(255 255 255 / 80%);
		cursor: pointer;
		display: flex;
		align-items: center;
		justify-content: center;
		transition: background 0.2s;

		&:hover {
			background: rgb(255 255 255 / 25%);
			color: white;
		}
	}
}

// Footer
.gallery-footer {
	display: flex;
	align-items: center;
	justify-content: center;
	gap: 12px;
	padding: 8px 0;

	&__counter {
		color: rgb(255 255 255 / 90%);
		font-variant-numeric: tabular-nums;
		font-weight: 600;
	}

	&__iteration {
		color: rgb(255 255 255 / 60%);
		font-size: 0.875rem;
	}
}

// Mobile: sidebar stacks above
@include mobile {
	.gallery-layout {
		flex-direction: column;
	}

	.gallery-sidebar {
		width: 100%;
		max-height: 40vh;
		overflow-y: auto;
		flex-shrink: 0;
	}

	.gallery-main {
		padding: 12px;
		flex: 1;
		min-height: 0;
	}
}

// Tablet: narrower sidebar
@include tablet {
	.gallery-sidebar {
		width: 300px;
	}
}
